(()=>{const e=e=>document.getElementById(e),t=e=>document.createElement(e);window.addEventListener("pageshow",e=>{e.persisted&&window.location.reload()});var a="aw-content-hider",o=".aw-card{background:#0d0d10;border:1px solid #1e1e24;color:#f5f7fb;border-radius:16px;padding:24px;text-align:center;font-family:system-ui,sans-serif;box-shadow:0 10px 30px rgba(0,0,0,.5)}.aw-btn{display:inline-flex;justify-content:center;align-items:center;min-height:48px;padding:10px 24px;border-radius:12px;font-weight:700;cursor:pointer;border:0;transition:.2s;font-size:16px;font-family:system-ui,sans-serif}.aw-btn:hover{transform:translateY(-1px)}.aw-title{margin:0 0 16px;font-size:24px;font-weight:700;color:#fff}.aw-desc{margin:0 0 24px;color:#c8cbd4;line-height:1.6;font-size:16px}";try{var r="body>*:not(.aw-gate-overlay){display:none!important}body{overflow:hidden!important;background:#000!important}"+o+".aw-gate-overlay{position:fixed;top:0;left:0;width:100vw;height:100vh;background:#000;z-index:2147483647;display:flex;justify-content:center;align-items:center;padding:24px;box-sizing:border-box}.aw-gate-card{max-width:500px;width:100%}.aw-error-card{max-width:500px;width:100%}.aw-gate-logo{display:block;margin:0 auto 20px;max-width:150px;height:auto}.aw-gate-buttons{display:flex;justify-content:center;gap:12px;margin-top:16px;flex-wrap:wrap}.aw-btn-no{background:#2a2a32;color:#cdd0d7}.aw-btn-no:hover{background:#3a3a44}.aw-btn-yes{background:#6a1b9a;color:#fff;box-shadow:0 6px 15px rgba(106,27,154,.25)}.aw-btn-yes:hover{background:#5a1784}.aw-error{margin-top:16px;color:#ff4d4f;font-size:14px;display:none}.aw-disclaimer{margin-top:20px;font-size:12px;color:#666}.aw-disclaimer a{color:#666;text-decoration:underline}",i=t("style");i.id=a,i.type="text/css",i.styleSheet?i.styleSheet.cssText=r:i.appendChild(document.createTextNode(r)),document.head.appendChild(i)}catch(e){}const n=()=>{var r=document.currentScript;if(!r)for(var i=document.getElementsByTagName("script"),n=0;n<i.length;n++)if(i[n].hasAttribute("data-client-id")){r=i[n];break}if(!r)return void x("Configuration Error","Could not locate AgeWallet configuration.");var d=r.getAttribute("data-client-id");if(!d)return void x("Configuration Error","Missing Client ID.");var c="aw_session_"+d,l=r.getAttribute("data-logo")||"https://www.agewallet.com/wp-content/uploads/2025/07/age-wallet-logo-light-tmb2-cleaned-300x225.png",s=r.getAttribute("data-css"),w=r.getAttribute("data-title")||"Age Verification",g=r.getAttribute("data-description")||"You must verify your age to view this content.",p=r.getAttribute("data-yes-label")||"Verify with AgeWallet",m=r.getAttribute("data-no-label")||"I Disagree",u=r.getAttribute("data-error-msg")||"Sorry, you do not meet the minimum requirements.",f=parseInt(r.getAttribute("data-expiry")||"1440",10),h="dev"===(r.getAttribute("data-env")||"prod")?"https://dev.agewallet.io":"https://app.agewallet.io";const y=e=>{try{for(e=e.replace(/-/g,"+").replace(/_/g,"/");e.length%4;)e+="=";return JSON.parse(atob(e))}catch(e){return null}},v=(e,t,a)=>{var o="";if(a){var r=new Date;r.setTime(r.getTime()+60*a*1e3),o="; expires="+r.toUTCString()}document.cookie=e+"="+(encodeURIComponent(t)||"")+o+"; path=/; SameSite=Lax"},b=e=>Array.from(crypto.getRandomValues(new Uint8Array(e)),e=>e.toString(16).padStart(2,"0")).join("");function x(r,i,n){if(!e(a)){var d=t("style");d.id=a,d.innerHTML="body>*:not(.aw-gate-overlay){display:none!important}body{overflow:hidden!important;background:#000!important}"+o+".aw-error-card{max-width:500px;width:100%}.aw-btn-no{background:#2a2a32;color:#cdd0d7}",document.head.appendChild(d)}var c=t("div");c.className="aw-gate-overlay";var l=n?"Try Again":"Reload Page",s=n||window.location.origin+window.location.pathname;c.innerHTML='<div class="aw-card aw-error-card"><div class="aw-title aw-error-title" style="color:#ff4d4f">'+r+'</div><div class="aw-desc aw-error-desc">'+i+'</div><button class="aw-btn aw-btn-no" id="aw-err-btn">'+l+"</button></div>",document.body.appendChild(c),document.getElementById("aw-err-btn").addEventListener("click",function(){window.location.href=s})}function S(){var e=(new Date).getTime()+60*f*1e3,t=JSON.stringify({v:1,e:e});((e,t,a)=>{try{localStorage.setItem(e,t)}catch(e){}v(e,t,a)})(c,t,f)}var k,A=window.__awParams||window.location.search,C=new URLSearchParams(A);if(C.has("code")&&C.has("state"))!async function(e,a){var o;(o=t("div")).className="aw-gate-overlay",o.innerHTML='<div class="aw-card aw-gate-card"><img src="'+l+'" class="aw-gate-logo" alt="Logo"><h1 class="aw-title aw-gate-title">Verifying...</h1><div style="border:4px solid rgba(255,255,255,.1);border-left-color:#6a1b9a;border-radius:50%;width:40px;height:40px;animation:spin 1s linear infinite;margin:20px auto"></div><style>@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}</style></div>',document.body.appendChild(o);var r=y(a);if(r&&r.v){var i=r.v,n=r.r?window.location.origin+r.r:"/",c=window.location.origin;try{var s=await fetch(h+"/embed/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:d,code:e,code_verifier:i,redirect_uri:c})}),w=await s.json();if(w.error)throw new Error(w.error_description||w.error);var g=await fetch(h+"/user/userinfo",{headers:{Authorization:"Bearer "+w.access_token}});!0===(await g.json()).age_verified?(S(),window.location.href=n):x("Verification Failed","Age requirement not met.")}catch(e){x("Verification Error",e.message||"Token exchange failed.")}}else x("Verification Error","Invalid state parameter.")}(C.get("code"),C.get("state"));else if(C.has("error")){var _=C.get("error"),T=C.get("error_description")||_;if("access_denied"===_&&"Region does not require verification"===T){var E=C.get("state"),I=E?y(E):null,L=I&&I.r?window.location.origin+I.r:"/";S(),window.location.href=L}else{var R=C.get("state"),N=R?y(R):null,U=N&&N.r?window.location.origin+N.r:window.location.origin;x("Verification Error",decodeURIComponent(T),U)}}else if(function(){var e=null;try{e=JSON.parse(localStorage.getItem(c))}catch(e){}if(!e){var t=document.cookie.match(new RegExp("(^| )"+c+"=([^;]+)"));if(t)try{e=JSON.parse(decodeURIComponent(t[2]))}catch(e){}}if(e&&e.v){if((new Date).getTime()<e.e)return e;localStorage.removeItem(c),v(c,"",-1)}return null}())!function(){e(a)&&e(a).remove();var t=document.querySelector(".aw-gate-overlay");t&&t.remove(),document.body.style.overflow="",document.body.style.backgroundColor=""}();else{if(s){var z=t("link");z.rel="stylesheet",z.href=s,document.head.appendChild(z)}(k=t("div")).className="aw-gate-overlay",k.innerHTML='<div class="aw-card aw-gate-card"><img src="'+l+'" class="aw-gate-logo" alt="Logo"><h1 class="aw-title aw-gate-title">'+w+'</h1><div class="aw-desc aw-gate-desc">'+g+'</div><div class="aw-gate-buttons"><button class="aw-btn aw-btn-no" id="aw-deny">'+m+'</button><button class="aw-btn aw-btn-yes" id="aw-verify">'+p+'</button></div><div class="aw-error" id="aw-error-msg">'+u+'</div><p class="aw-disclaimer">By proceeding you agree to allow <a href="https://agewallet.com" target="_blank">AgeWalletâ„¢</a> to verify your age.</p></div>',document.body.appendChild(k),e("aw-deny").onclick=()=>{e("aw-error-msg").style.display="block"},e("aw-verify").onclick=()=>async function(){var e,t=b(32),a=b(16),o=await(async e=>btoa(String.fromCharCode(...new Uint8Array(await crypto.subtle.digest("SHA-256",(new TextEncoder).encode(e))))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""))(t),r=(e={v:t,r:window.location.pathname+window.location.search},btoa(JSON.stringify(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")),i=window.location.origin,n=h+"/user/authorize?response_type=code&client_id="+encodeURIComponent(d)+"&redirect_uri="+encodeURIComponent(i)+"&scope=openid&state="+r+"&nonce="+a+"&code_challenge="+o+"&code_challenge_method=S256";window.location.href=n}()}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",n):n()})();