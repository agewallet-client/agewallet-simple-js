(()=>{const e=e=>document.getElementById(e),t=e=>document.createElement(e);window.addEventListener("pageshow",e=>{e.persisted&&window.location.reload()});var a="aw-content-hider",o=".aw-card{background:#0d0d10;border:1px solid #1e1e24;color:#f5f7fb;border-radius:16px;padding:24px;text-align:center;font-family:system-ui,sans-serif;box-shadow:0 10px 30px rgba(0,0,0,.5)}.aw-btn{display:inline-flex;justify-content:center;align-items:center;min-height:48px;padding:10px 24px;border-radius:12px;font-weight:700;cursor:pointer;border:0;transition:.2s;font-size:16px;font-family:system-ui,sans-serif}.aw-btn:hover{transform:translateY(-1px)}.aw-title{margin:0 0 16px;font-size:24px;font-weight:700;color:#fff}.aw-desc{margin:0 0 24px;color:#c8cbd4;line-height:1.6;font-size:16px}";try{var r="body>*:not(.aw-gate-overlay){display:none!important}body{overflow:hidden!important;background:#000!important}"+o+".aw-gate-overlay{position:fixed;top:0;left:0;width:100vw;height:100vh;background:#000;z-index:2147483647;display:flex;justify-content:center;align-items:center;padding:24px;box-sizing:border-box}.aw-gate-card{max-width:500px;width:100%}.aw-error-card{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2147483647;max-width:320px;width:90%}.aw-gate-logo{display:block;margin:0 auto 20px;max-width:150px;height:auto}.aw-gate-buttons{display:flex;justify-content:center;gap:12px;margin-top:16px;flex-wrap:wrap}.aw-btn-no{background:#2a2a32;color:#cdd0d7}.aw-btn-no:hover{background:#3a3a44}.aw-btn-yes{background:#6a1b9a;color:#fff;box-shadow:0 6px 15px rgba(106,27,154,.25)}.aw-btn-yes:hover{background:#5a1784}.aw-error{margin-top:16px;color:#ff4d4f;font-size:14px;display:none}.aw-disclaimer{margin-top:20px;font-size:12px;color:#666}.aw-disclaimer a{color:#666;text-decoration:underline}",n=t("style");n.id=a,n.type="text/css",n.styleSheet?n.styleSheet.cssText=r:n.appendChild(document.createTextNode(r)),document.head.appendChild(n)}catch(e){}const i=()=>{var r=document.currentScript;if(!r)for(var n=document.getElementsByTagName("script"),i=0;i<n.length;i++)if(n[i].hasAttribute("data-client-id")){r=n[i];break}if(!r)return void x("Configuration Error","Could not locate AgeWallet configuration.");var d=r.getAttribute("data-client-id");if(!d)return void x("Configuration Error","Missing Client ID.");var c="aw_session_"+d,s="aw_signal_"+d,l="aw_oidc_"+d,w=r.getAttribute("data-logo")||"https://www.agewallet.com/wp-content/uploads/2025/07/age-wallet-logo-light-tmb2-cleaned-300x225.png",g=r.getAttribute("data-css"),p=r.getAttribute("data-title")||"Age Verification",m=r.getAttribute("data-description")||"You must verify your age to view this content.",f=r.getAttribute("data-yes-label")||"Verify with AgeWallet",u=r.getAttribute("data-no-label")||"I Disagree",h=r.getAttribute("data-error-msg")||"Sorry, you do not meet the minimum requirements.",v=parseInt(r.getAttribute("data-expiry")||"1440",10);const y=(e,t,a)=>{var o="";if(a){var r=new Date;r.setTime(r.getTime()+60*a*1e3),o="; expires="+r.toUTCString()}document.cookie=e+"="+(encodeURIComponent(t)||"")+o+"; path=/; SameSite=Lax"},b=(e,t,a)=>{try{localStorage.setItem(e,t)}catch(e){}y(e,t,a)};function x(r,n){if(!e(a)){var i=t("style");i.id=a,i.innerHTML="body>*:not(.aw-gate-overlay){display:none!important}body{overflow:hidden!important;background:#000!important}"+o+".aw-error-card{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2147483647;width:90%;max-width:320px}.aw-btn-no{background:#2a2a32;color:#cdd0d7}",document.head.appendChild(i)}var d=t("div");d.className="aw-card aw-error-card",d.innerHTML='<div class="aw-title aw-error-title" style="color:#ff4d4f">'+r+'</div><div class="aw-desc aw-error-desc">'+n+'</div><button class="aw-btn aw-btn-no" onclick="window.location.reload()">Reload Page</button>',document.body.appendChild(d)}var S=new URLSearchParams(window.location.search);function k(e){var t=e.get("code"),a=e.get("state");function o(){if(!window.opener||window.opener.closed)return!1;try{return window.opener.postMessage({type:"agewallet_verified",code:t,state:a,timestamp:(new Date).getTime()},window.location.origin),!0}catch(e){return!1}}if(!o())var r=0,n=setInterval(function(){r++,(o()||r>5)&&clearInterval(n)},200);try{var i=JSON.stringify({c:t,s:a,t:(new Date).getTime()});localStorage.setItem(s,i),document.cookie=s+"="+encodeURIComponent(i)+"; path=/; SameSite=Lax"}catch(e){}setTimeout(function(){try{window.close()}catch(e){}},1e3)}S.has("code")&&S.has("state")?window.opener?k(S):async function(e){var t=e.get("code"),a=e.get("state"),o=(e=>{try{for(e=e.replace(/-/g,"+").replace(/_/g,"/");e.length%4;)e+="=";return JSON.parse(atob(e))}catch(e){return null}})(a);if(o&&o.v)try{var r=o.v,n=o.r||window.location.pathname,i=window.location.origin,s=await fetch("https://app.agewallet.io/embed/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:d,code:t,code_verifier:r,redirect_uri:i})}),l=await s.json();if(l.error)throw new Error(l.error_description);var w=await fetch("https://app.agewallet.io/user/userinfo",{headers:{Authorization:"Bearer "+l.access_token}});if(!0===(await w.json()).age_verified){var g=(new Date).getTime()+60*v*1e3,p=JSON.stringify({v:1,e:g});b(c,p,v),window.location.href=n}else alert("Verification failed."),window.location.href=n}catch(e){window.location.href=window.location.pathname}else k(e)}(S):function(){var o=null;try{o=JSON.parse(localStorage.getItem(c))}catch(e){}if(!o){var r=document.cookie.match(new RegExp("(^| )"+c+"=([^;]+)"));if(r)try{o=JSON.parse(decodeURIComponent(r[2]))}catch(e){}}if(o&&o.v){if((new Date).getTime()<o.e)return e(a)&&e(a).remove(),document.body.style.overflow="",void(document.body.style.backgroundColor="");localStorage.removeItem(c),y(c,"",-1)}if(g){var n=t("link");n.rel="stylesheet",n.href=g,document.head.appendChild(n)}!function(){var o=t("div");o.className="aw-gate-overlay",o.innerHTML='<div class="aw-card aw-gate-card"><img src="'+w+'" class="aw-gate-logo" alt="Logo"><h1 class="aw-title aw-gate-title">'+p+'</h1><div class="aw-desc aw-gate-desc">'+m+'</div><div class="aw-gate-buttons"><button class="aw-btn aw-btn-no" id="aw-deny">'+u+'</button><button class="aw-btn aw-btn-yes" id="aw-verify">'+f+'</button></div><div class="aw-error" id="aw-error-msg">'+h+'</div><p class="aw-disclaimer">By proceeding you agree to allow <a href="https://agewallet.com" target="_blank">AgeWalletâ„¢</a> to verify your age.</p></div>',document.body.appendChild(o),e("aw-deny").onclick=()=>{e("aw-error-msg").style.display="block"};var r=e("aw-verify");r.onclick=()=>async function(t){var o=window.location.origin;const r=e=>Array.from(crypto.getRandomValues(new Uint8Array(e)),e=>e.toString(16).padStart(2,"0")).join(""),n=async e=>btoa(String.fromCharCode(...new Uint8Array(await crypto.subtle.digest("SHA-256",(new TextEncoder).encode(e))))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");var i=r(32),g=r(32),p=r(64),m=window.open("","agewallet_verify","width=1024,height=800");if(!m||m.closed||void 0===m.closed)return void alert("Popups are blocked. Please allow popups for this site to verify your age.");var u='<style>body{background:#0d0d10;color:#fff;font-family:system-ui,sans-serif;display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;margin:0}.logo{max-width:150px;margin-bottom:20px}.spinner{border:4px solid rgba(255,255,255,.1);border-left-color:#6a1b9a;border-radius:50%;width:40px;height:40px;animation:spin 1s linear infinite;margin-bottom:15px}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}p{color:#c8cbd4;font-size:16px}</style><body><img src="'+w+'" class="logo"><div class="spinner"></div><p>Connecting to AgeWallet...</p></body>';m.document.write(u),t.innerText="Verifying...";var h=await n(p);sessionStorage.setItem(l,JSON.stringify({s:i,v:p,n:g}));var y="https://app.agewallet.io/user/authorize?response_type=code&client_id="+d+"&redirect_uri="+encodeURIComponent(o)+"&scope=openid&state="+i+"&nonce="+g+"&code_challenge="+h+"&code_challenge_method=S256";setTimeout(()=>{m.location.href=y},100),function(t,o,r){var n,i=!1;async function w(w){if(w.s===t&&!i){i=!0,n&&clearInterval(n),window.removeEventListener("storage",p),window.removeEventListener("message",g),localStorage.removeItem(s),document.cookie=s+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",r.innerText="Finalizing...";try{var m=JSON.parse(sessionStorage.getItem(l));if(!m)throw new Error("Missing OIDC");var u=await fetch("https://app.agewallet.io/embed/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:d,code:w.c,code_verifier:m.v,redirect_uri:o})}),h=await u.json();if(h.error)throw new Error(h.error);var y=await fetch("https://app.agewallet.io/user/userinfo",{headers:{Authorization:"Bearer "+h.access_token}});if(!0===(await y.json()).age_verified){e(a)&&e(a).remove(),document.querySelector(".aw-gate-overlay")&&document.querySelector(".aw-gate-overlay").remove(),document.body.style.overflow="",document.body.style.backgroundColor="";var x=(new Date).getTime()+60*v*1e3,S=JSON.stringify({v:1,e:x});b(c,S,v)}else alert("Verification failed."),r.innerText=f}catch(e){alert("Error."),r.innerText=f}}}function g(e){e.origin===window.location.origin&&(e.data&&"agewallet_verified"===e.data.type&&w({c:e.data.code,s:e.data.state,t:e.data.timestamp}))}function p(e){if(e.key===s&&e.newValue)try{w(JSON.parse(e.newValue))}catch(e){}}window.addEventListener("message",g),window.addEventListener("storage",p),n=setInterval(function(){try{var e=localStorage.getItem(s);e&&w(JSON.parse(e))}catch(e){}var t=document.cookie.match(new RegExp("(^| )"+s+"=([^;]+)"));if(t)try{w(JSON.parse(decodeURIComponent(t[2])))}catch(e){}},500),setTimeout(function(){clearInterval(n),window.removeEventListener("message",g),window.removeEventListener("storage",p),i||(r.innerText=f,alert("Verification timed out. This can happen in private browsing mode.\n\nPlease try again, or use normal browsing mode."))},12e4)}(i,o,t)}(r)}()}()};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",i):i()})();